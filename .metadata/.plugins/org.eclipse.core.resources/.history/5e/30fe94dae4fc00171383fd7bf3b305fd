package net.qhhhq.base.dao;

import java.io.Serializable;
import java.util.HashMap;
import java.util.LinkedHashMap;
import java.util.List;
import java.util.Map;

import net.qhhhq.api.base.DAO;
import net.qhhhq.base.QueryResult;

public abstract class DaoSupport<T> implements DAO<T> {

	public abstract BaseMapper<T> getMapper();

	public void save(T entity) {
		getMapper().insert(entity);
	}

	public void update(T eitity) {
		getMapper().updateByPrimaryKey(eitity);
	}

	public void delete(Serializable... entityIds) {
		for(Object id : entityIds) {
			getMapper().deleteByPrimaryKey(id);
		}
	}

	public T find(Serializable... entityId) {
		return getMapper().selectByPrimaryKey(entityId);
	}

	public long getCount() {
		return getMapper().getCount();
	}

	public QueryResult<T> getScrollData() {
		return getMapper().queryAllRecords(null);
	}

	public QueryResult<T> getScrollData(int firstResult, int maxResult) {
		Map<String, Object> map = new HashMap<String, Object>();
		map.put("firstResult", firstResult);
		map.put("maxResult", maxResult);
		return getMapper().queryAllRecords(map);
	}

	public QueryResult<T> getScrollData(int firstResult, int maxResult, LinkedHashMap<String, String> orderBy) {
		Map<String, Object> map = new HashMap<String, Object>();
		map.put("firstResult", firstResult);
		map.put("maxResult", maxResult);
		map.put("orderBy", orderBy);
		return getMapper().queryAllRecords(map);
	}

	public QueryResult<T> getScrollData(int firstResult, int maxResult, Map<String, Object> where) {
		where = new HashMap<String, Object>();
		where.put("firstResult", firstResult);
		where.put("maxResult", maxResult);
		return getMapper().queryAllRecords(where);
	}

	public QueryResult<T> getScrollData(int firstResult, int maxResult, Map<String, Object> where,
			LinkedHashMap<String, String> orderBy) {
		Map<String, Object> whereMap = new HashMap<String, Object>();
		if(firstResult != -1) {
			where.put("firstResult", firstResult);
		}
		if(maxResult != -1) {
			where.put("maxResult", maxResult);
		}
		if(where != null) {
			whereMap = where;
		}
		if()

		where.put("orderBy", orderBy);
		List<T> records = getMapper().queryAllRecords(whereMap);
		long totalRecords = getMapper().queryTotalRecords(where);
		QueryResult<T> result = new QueryResult<T>();
		result.setRecordTotal(totalRecords);
		result.setResultList(records);
		return result;
	}

}
